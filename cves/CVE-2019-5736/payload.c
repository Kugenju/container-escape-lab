/*
 * Malicious payload that replaces runc on the host.
 * Instead of a reverse shell, it simply creates a proof file on the host.
 * Safe for lab use.
 */

#include <stdio.h>
#include <unistd.h>

int main(int argc, char **argv) {
    printf("!!! ESCAPE SUCCESSFUL !!! Host runc was hijacked.\n");
    fflush(stdout);
    
    // 尝试执行原始命令（避免 docker run 报错）
    if (argc > 1) {
        execvp(argv[1], argv+1);
    }
    return 0;
}