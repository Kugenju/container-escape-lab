# 构建易受 CVE-2019-5736 攻击的容器镜像
# 基于 Ubuntu 18.04（自带 runc < 1.0-rc6）
FROM ubuntu:18.04
#FROM hub.uuuadc.top/library/ubuntu:18.04

LABEL maintainer="Security Researcher"
LABEL description="CVE-2019-5736 PoC - FOR AUTHORIZED TESTING ONLY"

# 安装必要工具
RUN apt-get update && \
    apt-get install -y \
        build-essential \
        curl \
        wget \
        gcc \
        && rm -rf /var/lib/apt/lists/*

# 将 exploit 和 payload 源码复制进容器
COPY exploit.c /exploit.c
COPY payload.c /payload.c

# 编译 payload
RUN gcc -static -o /payload /payload.c

# 编译 exploit
RUN gcc -o /exploit /exploit.c

# 设置入口点为 exploit（自动触发）
ENTRYPOINT ["/exploit"]
